{{ block title }}
Page title
{{ endblock }}

{{ block styles }}
<link href="{{ static 'fullscreen.css' }}" rel="stylesheet" />
<link href="{{ static 'common.css' }}" rel="stylesheet" />
<link href="{{ static 'demo_chat.css' }}" rel="stylesheet" />
{{ endblock }}

{{ block scripts }}
<script type="module" src="{{ static 'otree-front-1.0.0.js' }}"></script>
<script src="{{ static 'live_utils.js' }}"></script>
<script src="{{ static 'demo_chat.js' }}"></script>
{{ endblock }}

{{ block content }}

{{ if player.role == C.SUPERVISOR_ROLE }}
<h5>You're randomly assigned a supervisor role</h5>
{{ endif }}

<div ot-if="stage == 'joining'" class="fullscreen welcome flex-col">
    <h5>Welcome to the chat!</h5>
    <div class="input-group">
        <input class="form-control" type="text" ot-input="nickname" autofocus placeholder="Enter your nickname">
        <button type="button" class="btn btn-outline-secondary" ot-emit="chat.join">send</button>
    </div>
</div>

<div ot-if="stage == 'chatting'" class="flex-col">
    <div class="main">
        <div class="party">
            {{ for i in range(0, 10) }}
            <div class="player" ot-text="party.{{i}}" ot-click ot-input="recipient = {{i}}"></div>
            {{ endfor }}
        </div>
        <div class="chat">
            {{ for i in range(0, 10) }}
            <div class="msg" ot-class="chat.{{i}}.class">
                <span class="source" ot-text="chat.{{i}}.source"></span>
                <span class="destination" ot-if="chat.{{i}}.dest"> → <span ot-text="chat.{{i}}.dest"></span></span>
                <b ot-if="chat.{{i}}.source">:</b>
                <span class="text" ot-text="chat.{{i}}.text"></span>
            </div>
            {{ endfor }}
        </div>
    </div>
    <div class="input-group">
        <button type="button" class="btn btn-outline-secondary" ot-emit="chat.clear">❌</button>
        <input class="form-control" ot-input="text" placeholder="type your message here and press enter">
        <span ot-if="recipient" class="input-group-text">→ <span ot-text="recipient"></span></span>
        <button type="button" class="btn btn-outline-secondary" ot-emit="chat.send">send</button>
    </div>
    <p>Click on user nickname to send wisper</p>

    <div class="input-group">
        <button type="button" class="btn btn-outline-secondary" ot-emit="chat.leave">leave chat</button>
    </div>
</div>

<div ot-if="stage == 'leaving'" class="fullscreen welcome flex-col">
    <h5>Good-bye!</h5>
</div>

{{ endblock }}